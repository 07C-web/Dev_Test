<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Absensi Lokasi Online - Dev Test</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>

<script>
(function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition, showError);
  } else {
    Swal.fire("Error", "Browser tidak mendukung geolocation", "error");
  }
})();

function showPosition(position) {
  const lat = position.coords.latitude;
  const lng = position.coords.longitude;

  // Ganti dengan URL Web App Apps Script kamu
  const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxtbWhxLynQNtJU5kUZ_ERU9OYXb5-skGUZARgzsISFHl4V6fDiij7rb_jFSZ2MW5oG/exec";

  fetch(APPS_SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({ lat: lat, lng: lng }),
    headers: { "Content-Type": "application/json" }
  })
  .then(response => response.json())
  .then(data => {
    if (data.status === "ok" || data.status === "success") {
      Swal.fire({
        title: "Absensi Berhasil",
        text: "Lokasi berhasil direkam.\nTerimakasih!",
        icon: "success"
      }).then(() => {
        // Redirect ke halaman GitHub Pages dev-test
        window.location.href = "https://07c-web.github.io/Dev_Test/";
      });
    } else {
      Swal.fire("Error", "Gagal menyimpan lokasi: " + (data.message || ""), "error");
    }
  })
  .catch(err => {
    Swal.fire("Error", "Terjadi kesalahan saat mengirim data ke server", "error");
    console.error(err);
  });
}

function showError(error) {
  Swal.fire("Error", "Tidak bisa mengambil lokasi. Izinkan akses lokasi.", "error");
}
</script>

</body>
</html>
